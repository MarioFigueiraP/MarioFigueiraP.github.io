<!DOCTYPE html>
<html lang="es" dir="ltr">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="description" content="Breve introducción y ejemplificación de la organización de información en Stacks.">
    <meta name="author" content="Mario Figueira">
    <title>Stacks :: Documentación</title>
    <link href="https://MarioFigueiraP.github.io/es/inla/basicoperationalinfo/stacks/index.html" rel="canonical" type="text/html" title="Stacks :: Documentación">
    <link href="../../../../es/inla/basicoperationalinfo/stacks/index.xml" rel="alternate" type="application/rss+xml" title="Stacks :: Documentación">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="../../../../css/fontawesome-all.min.css" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fontawesome-all.min.css" rel="stylesheet"></noscript>
    <link href="../../../../css/featherlight.min.css" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/featherlight.min.css" rel="stylesheet"></noscript>
    <link href="../../../../css/auto-complete.css" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/auto-complete.css" rel="stylesheet"></noscript>
    <link href="../../../../css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="../../../../css/nucleus.css" rel="stylesheet">
    <link href="../../../../css/fonts.css" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fonts.css" rel="stylesheet"></noscript>
    <link href="../../../../css/theme.css" rel="stylesheet">
    <link href="../../../../css/theme-learn.css" rel="stylesheet" id="variant-style">
    <link href="../../../../css/ie.css" rel="stylesheet">
    <link href="../../../../css/variant.css" rel="stylesheet">
    <link href="../../../../css/print.css" rel="stylesheet" media="print">
    <link href="../../../../css/format-print.css" rel="stylesheet">
    <script src="../../../../js/url.js"></script>
    <script src="../../../../js/variant.js"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="../../../../es/index.search.js";
      var root_url="../../../../";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copiar en el portapapeles';
      window.T_Copied_to_clipboard = '¡Copiado al portapapeles!';
      window.T_Copy_link_to_clipboard = 'Copiar enlace al portapapeles';
      window.T_Link_copied_to_clipboard = '¡Enlace copiado al portapapeles!';
      window.T_No_results_found = 'No se han encontrado resultados para \u0022{0}\u0022';
      window.T_N_results_found = '{1} resultados encontrados para \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/MarioFigueiraP.github.io/';
      window.variants && variants.init( [ 'learn', 'relearn-light', 'relearn-dark', 'neon', 'blue', 'green', 'red' ] );
    </script>
    <script src="../../../../js/jquery.min.js" defer></script>
  </head>
  <body class="mobile-support print" data-url="../../../../es/inla/basicoperationalinfo/stacks/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menú (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../es/inla/index.html"><span itemprop="name">INLA</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../es/inla/basicoperationalinfo/index.html"><span itemprop="name">Operaciones Básicas</span></a><meta itemprop="position" content="2"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Stacks</span><meta itemprop="position" content="3"></li>
            </ol>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="default">
<h1 id="stacks">Stacks</h1>


<div class="box notices cstyle info">
    <div class="box-label"><i class="fa-fw fas fa-info"></i> Información de versiones</div>
    <div class="box-content">
<p>En este rótulo inicial exponemos una lista con las versiones de los programas, sistema operativo y librearías con las que se ha ejecutado el código de la presente sección, lo cual se extrae principalmente mediante la función <code>sessionInfo()</code>.</p>
<ul>
<li>SO (version): Windows 11 Home (22H2).</li>
<li>R: 4.2.3 (2023-03-15 ucrt).</li>
<li>RStudio: 2023.06.2 (Build 561).</li>
<li>Libraries:
<ul>
<li>INLA: INLA_23.04.24</li>
</ul>
</li>
</ul>
    </div>
</div>
<p>Los <code>stack</code> son unas funciones implementadas en el paquete <strong>R-INLA</strong> que permite organizar la información necesaria de una fórma verátil y cómoda para posteriormente ser integrada en la llamada a la función de ajuste <code>inla(...)</code>. La función empleada para ello es <code>inla.stack(...)</code>, la cual produce un objeto <code>inla.data.stack</code>.</p>
<h2 id="1-estructura-de-un-stack">1. Estructura de un <em>stack</em></h2>
<p>La función <code>inla.stack(...)</code> organiza la información de la variable respuesta (<em>data</em>), los efectos del modelo (<em>effects</em>) y la matriz de proyección (<em>A</em>), matriz 
<span class="math align-center">$\mathbf{A}$</span> que liga el campo latente 
<span class="math align-center">$\mathbf{\mathcal{X}}$</span> con el predictor lineal 
<span class="math align-center">$\boldsymbol\eta$</span>. Por tanto, se dispondrá de un argumento asociado a cada uno de estos tres elementos, que será definido a través de una lista, junto con otros argumentos como <code>tag</code> que permite nombrar dicho <em>stack</em> y así, posteriormente, extraer índices o información según la etiqueta del <em>stack</em>.</p>
<p>La estructura del código quedaría sintetizada en el siguiente bloque de código:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="kc">...</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="kc">...</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">effects</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="kc">...</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tag</span> <span class="o">=</span> <span class="s">&#34;stack_label&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><p>La función <code>inla.stack(...)</code> permite agrupar (<em>stakear</em>) otros objetos que sean ellos mismos también objetos de la clase <code>inla.data.stack</code>. Esto se debe a que la propia función <code>inla.stack(...)</code> es una función que llama a otras dos, <code>inla.stack.sum(...)</code> e <code>inla.stack.join(...)</code>, según se los argumentos introducidos sean los anteriormente expuestos o sean objetos <code>inla.data.stack</code>. En el primer caso se llamaría a la función <code>inla.stack.sum(...)</code>, mientras que en el segundo se llamaría a la función <code>inla.stack.join(...)</code>.</p>
<p>Además, hay otros dos argumentos, ligados a la función <code>inla.stack.sum(...)</code> que pueden, ser de gran utilidad en determinados casos: <code>compress</code> y <code>remove.unused</code>. El primero eliminaría elementos duplicados en los efectos, y por tanto eliminaría las columnas asociadas a <em>A</em> relativas a dichos efectos, mientras que el segundo argumento eliminaría aquellos efectos que tienen valores nulos para toda la columna en <em>A</em> (eliminando también dichas columnas). Esto podremos observarlo en el pequeño ejemplo muy <em>naive</em> dedicado a un modelo espacial.</p>
<p>En definitiva, la función permite automatizar la organización de los datos, por la generación <code>NAs</code> donde es necesario en el <code>data.frame</code> de los efectos y la integración de las matrices de proyección de los efectos y de distintos <em>stacks</em> cuando son agregados. Además, permite que la estructura general del código sea más legible al poder escindir partes del modelo en distintos <em>stacks</em> y así facilitar la escritura y lectura de código al apoyarnos en estas funciones.</p>
<h2 id="2-ejemplos-de-uso-con-toy-models">2. Ejemplos de uso con <em>toy models</em></h2>
<p>En este apartado expondremos unos breves ejemplos del uso de los <em>stacks</em> con unos modelos muy sencillos. Estos modelos emplean datos simulados y pueden ser demasiado simples, particularmente el segundo es un ejemplo algo artificial pero el objeto es tratar de exponer ejemplos variados para formar <em>stacks</em>. Los ejemplos son:</p>
<ol>
<li>Un modelo con dos efectos fijos.</li>
<li>Un modelo con interceptor y un efecto aleatorio <em>iid</em>.</li>
<li>Un modelo con interceptor y un efecto aleatorio espacialmente estructurado.</li>
</ol>
<h3 id="21-modelo-lineal-sin-efectos-aleatorios">2.1 Modelo lineal sin efectos aleatorios</h3>
<p>En este ejemplo vamos a simular un modelo Gaussiano con un interceptor 
<span class="math align-center">$(\beta_0)$</span> y un efecto fijo asociado a una variable explicativa numérica continua 
<span class="math align-center">$(\beta_1, \mathbf{x}\in\mathbb{R})$</span>.</p>
<p>El código necesario para la simulación es el siguiente</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">beta_0</span> <span class="o">&lt;-</span> <span class="m">-2</span>
</span></span><span class="line"><span class="cl"><span class="n">beta_1</span> <span class="o">&lt;-</span> <span class="m">4</span>
</span></span><span class="line"><span class="cl"><span class="n">lin_pred</span> <span class="o">&lt;-</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span><span class="o">*</span><span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">lin_pred</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span></code></pre></div><p>Dados estos datos, podemos organizar la información en un <em>stack</em> según cualquiera de las siguientes alternativas:</p>

<div class="tab-panel">
  <div class="tab-nav">
    <button
      data-tab-item="Alt. 1"
      data-tab-group="default"
      class="tab-nav-button direction-ltr active"
      onclick="switchTab('default','Alt. 1')"
      ><span>Alt. 1</span></button>
    <button
      data-tab-item="Alt. 2"
      data-tab-group="default"
      class="tab-nav-button direction-ltr "
      onclick="switchTab('default','Alt. 2')"
      ><span>Alt. 2</span></button>
    <button
      data-tab-item="Alt. 3"
      data-tab-group="default"
      class="tab-nav-button direction-ltr "
      onclick="switchTab('default','Alt. 3')"
      ><span>Alt. 3</span></button>
  </div>
  <div class="tab-content">
    <div data-tab-item="Alt. 1" data-tab-group="default" class="tab-item active">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="m">1E2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">beta_1</span><span class="o">=</span><span class="n">x</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">        <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span></code></pre></div>
    </div>
    <div data-tab-item="Alt. 2" data-tab-group="default" class="tab-item ">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="m">1E2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">beta_1</span><span class="o">=</span><span class="n">x</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span></code></pre></div>
    </div>
    <div data-tab-item="Alt. 3" data-tab-group="default" class="tab-item ">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="nf">Diagonal</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="m">1</span><span class="p">),</span> <span class="nf">Diagonal</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">        <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="m">1E2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="n">beta_1</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="m">1E2</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">        <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span></code></pre></div>
    </div>
  </div>
</div>
<p>Con independencia de cual de las alternativas escojamos para construir el <em>stack</em> podremos emplear el mismo código para llamar a la función <code>inla(...)</code> y ajustar el modelo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inla_model</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">inla</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">formula</span><span class="o">=</span><span class="n">y</span><span class="o">~</span><span class="m">-1</span><span class="o">+</span><span class="n">beta_0</span><span class="o">+</span><span class="n">beta_1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">family</span><span class="o">=</span><span class="s">&#34;gaussian&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nf">inla.stack.data</span><span class="p">(</span><span class="n">inf_stack</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">control.predictor</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="nf">inla.stack.A</span><span class="p">(</span><span class="n">inf_stack</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span></code></pre></div><p>En la función <code>inla(...)</code> el argumento <code>data</code> es relativo a los datos de los modelos, debiendo hacer coincidir los nombres de los elementos entre la fórmula y los almacenados en el <em>stack</em>, los datos se extraen (como una lista) mediante la función <code>inla.stack.data</code>. Por otro lado, <code>control.predictor</code> es un argumento que nos permite definir una lista de argumentos relativos a opciones de configuración del predictor, particulamente hacemos uso del argumento <code>A</code>, que define la matriz de proyección y que podemos extraer del <em>stack</em> mediante la función <code>inla.stack.A</code>.</p>
<h3 id="22-modelo-lineal-con-efecto-aleatorio-iid">2.2 Modelo lineal con efecto aleatorio <em>iid</em></h3>
<p>En este caso simularemos un modelo con un interceptor y con un efecto aleatorio <em>iid</em>. Para ello nos valemos del siguiente código:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">beta_0</span> <span class="o">&lt;-</span> <span class="m">-2</span>
</span></span><span class="line"><span class="cl"><span class="n">w</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="o">/</span><span class="m">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">lin_pred</span> <span class="o">&lt;-</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="nf">c</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="m">50</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">lin_pred</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span>
</span></span></code></pre></div><p>En este caso estaríamos definiendo el predictor lineal como 
<span class="math align-center">$\boldsymbol\eta\equiv \left\lbrace \eta_{1:50}=\beta_0 + w_{1:50},\; \eta_{51:100}=\beta_0 \right\rbrace $</span>, tal que 
<span class="math align-center">$ \mathbf{w} \sim N(0, \tau=0.04)$</span>. La definición del <em>stack</em> ahora será un poco distinta, dado que debemos definir el interceptor para todo el predictor lineal y separar los dos efectos <em>iid</em> según la posición asociada al predictor. Algunas alternativas posibles de escribir correctamente los datos en un <em>stack</em> son las siguientes:</p>

<div class="tab-panel">
  <div class="tab-nav">
    <button
      data-tab-item="Alt. 1"
      data-tab-group="default"
      class="tab-nav-button direction-ltr active"
      onclick="switchTab('default','Alt. 1')"
      ><span>Alt. 1</span></button>
    <button
      data-tab-item="Alt. 2"
      data-tab-group="default"
      class="tab-nav-button direction-ltr "
      onclick="switchTab('default','Alt. 2')"
      ><span>Alt. 2</span></button>
  </div>
  <div class="tab-content">
    <div data-tab-item="Alt. 1" data-tab-group="default" class="tab-item active">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="m">100</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">w</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">50</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="m">50</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="p">)),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span><span class="p">)</span>
</span></span></code></pre></div>
    </div>
    <div data-tab-item="Alt. 2" data-tab-group="default" class="tab-item ">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="m">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nf">Diagonal</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">100</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="m">50</span><span class="p">),</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="m">50</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="m">100</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="n">w</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">100</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span><span class="p">)</span>
</span></span></code></pre></div>
    </div>
  </div>
</div>
<p>Finalmente, la llamada a la función de ajuste es idéntica al anterior caso, con la excepción de que el argumento de la fórmula debemos cambiarlo para el nuevo modelo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inla_model</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">inla</span><span class="p">(</span> 
</span></span><span class="line"><span class="cl">    <span class="n">formula</span><span class="o">=</span><span class="n">y</span><span class="o">~</span><span class="m">-1</span> <span class="o">+</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="nf">f</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s">&#34;iid&#34;</span><span class="p">,</span> <span class="n">constr</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">family</span><span class="o">=</span><span class="s">&#34;gaussian&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nf">inla.stack.data</span><span class="p">(</span><span class="n">inf_stack</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">control.predictor</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="nf">inla.stack.A</span><span class="p">(</span><span class="n">inf_stack</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><h3 id="23-modelo-lineal-con-efectos-aleatorios-espacialmente-estructurados">2.3 Modelo lineal con efectos aleatorios espacialmente estructurados</h3>
<p>En este último ejemplo simularemos datos con estructura espacial, en el que aprovecharemos para mostrar las diferencias de dejar algunos argumentos de forma predeterminada en la función <code>inla.stack(...)</code>.</p>
<p>La simulación de datos con dependencia espacial podemos hacerlo mediante el siguiente código, en el que se configura una malla, y los objetos necesarios del SPDE para simular un campo Gaussiano con función de covarianzas tipo Matèrn.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mesh</span> <span class="o">&lt;-</span> <span class="nf">inla.mesh.2d</span><span class="p">(</span><span class="n">loc.domain</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                                         <span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                     <span class="n">max.edge</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.05</span><span class="p">,</span><span class="m">0.1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">spde</span> <span class="o">&lt;-</span> <span class="nf">inla.spde2.pcmatern</span><span class="p">(</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                            <span class="n">alpha</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                            <span class="n">prior.range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.5</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                            <span class="n">prior.sigma</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                            <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Q</span> <span class="o">&lt;-</span> <span class="nf">inla.spde2.precision</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">spde</span><span class="o">=</span><span class="n">spde</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="n">theta</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="m">0.2</span><span class="p">),</span><span class="nf">log</span><span class="p">(</span><span class="m">1</span><span class="p">))</span> <span class="c1"># log(range), log(stdev.)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">u</span> <span class="o">&lt;-</span> <span class="nf">inla.qsample</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">Q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">sample.locations</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">runif</span><span class="p">(</span><span class="m">5E2</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">A_u</span> <span class="o">&lt;-</span> <span class="nf">inla.spde.make.A</span><span class="p">(</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">sample.locations</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">beta_0</span> <span class="o">&lt;-</span> <span class="m">-2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">lin_pred</span> <span class="o">&lt;-</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="nf">as.vector</span><span class="p">(</span><span class="n">A_u</span> <span class="o">%*%</span> <span class="n">u</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">length</span><span class="p">(</span><span class="n">lin_pred</span><span class="p">),</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">lin_pred</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">0.25</span><span class="p">)</span>
</span></span></code></pre></div><p>Las localizaciones de simulación son <code>sample.locations</code>, tal que el efecto espacial se simula en los nodos de la malla a dichas localizaciones a través de la matriz de proyección <code>A_u</code>, matriz que también será integrada en el <em>stack</em> para la matriz de proyección del efecto espacial.</p>
<p>El <em>stack</em> para el modelo espacial podemos contruirlo según el siguiente código:</p>

<div class="tab-panel">
  <div class="tab-nav">
    <button
      data-tab-item="Alt. 1"
      data-tab-group="default"
      class="tab-nav-button direction-ltr active"
      onclick="switchTab('default','Alt. 1')"
      ><span>Alt. 1</span></button>
    <button
      data-tab-item="Alt. 2"
      data-tab-group="default"
      class="tab-nav-button direction-ltr "
      onclick="switchTab('default','Alt. 2')"
      ><span>Alt. 2</span></button>
    <button
      data-tab-item="Alt. 3"
      data-tab-group="default"
      class="tab-nav-button direction-ltr "
      onclick="switchTab('default','Alt. 3')"
      ><span>Alt. 3</span></button>
    <button
      data-tab-item="Alt. 4"
      data-tab-group="default"
      class="tab-nav-button direction-ltr "
      onclick="switchTab('default','Alt. 4')"
      ><span>Alt. 4</span></button>
  </div>
  <div class="tab-content">
    <div data-tab-item="Alt. 1" data-tab-group="default" class="tab-item active">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">A_u</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      <span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">spatial</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">spde</span><span class="o">$</span><span class="n">n.spde</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div>
    </div>
    <div data-tab-item="Alt. 2" data-tab-group="default" class="tab-item ">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">A_u</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">        <span class="n">spatial</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">spde</span><span class="o">$</span><span class="n">n.spde</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div>
    </div>
    <div data-tab-item="Alt. 3" data-tab-group="default" class="tab-item ">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">A_u</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      <span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">spatial</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">spde</span><span class="o">$</span><span class="n">n.spde</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">compress</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">remove.unused</span> <span class="o">=</span> <span class="kc">FALSE</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div>
    </div>
    <div data-tab-item="Alt. 4" data-tab-group="default" class="tab-item ">
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">A_u</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">        <span class="n">spatial</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="n">spde</span><span class="o">$</span><span class="n">n.spde</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">compress</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">remove.unused</span> <span class="o">=</span> <span class="kc">FALSE</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div>
    </div>
  </div>
</div>
<p>En las alternativas 1 y 2 simplemente tenemos dos formas distintas de formar el <em>stack</em>, mientras que las alternativas 3 y 4 son respectivamente la 1 y 2, pero eliminando la compresión o simplificación de la matriz de proyección y de los efectos. Si comparamos la matriz de proyección almacenada en el objeto <code>inf_stack</code>, entre las alternativas 1-2 y 3-4 podremos observar que las dimensiones para las dos primeras es inferior a las de las dos últimas, dado que se eliminarían los índices del efecto espacial asociados a las columnas de la matriz de proyección cuyas columnas sólo contengan valores nulos (debido al argumento predeterminado <code>remove.unused = TRUE</code>), junto con la eliminación de estas columnas de valores cero.</p>
<p>Finalmente para ajustar el modelo el código necesario es básicamente el ya empleado, pero cambiando la expresión de la fórmula para el modelo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inla_model</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">inla</span><span class="p">(</span> 
</span></span><span class="line"><span class="cl">    <span class="n">formula</span><span class="o">=</span><span class="n">y</span><span class="o">~</span><span class="m">-1</span> <span class="o">+</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="nf">f</span><span class="p">(</span><span class="n">spatial</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">spde</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">family</span><span class="o">=</span><span class="s">&#34;gaussian&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nf">inla.stack.data</span><span class="p">(</span><span class="n">inf_stack</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">control.predictor</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="nf">inla.stack.A</span><span class="p">(</span><span class="n">inf_stack</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span></code></pre></div><h2 id="3-funciones-extras-para-los-stacks">3. Funciones extras para los <em>stacks</em></h2>
<p>Otras funciones que podemos utilizar sobre los <em>stacks</em> son <code>inla.stack.index(...)</code>, <code>inla.stack.LHS(...)</code> y <code>inla.stack.RHS(...)</code>.</p>
<p>La primera función requiere de dos argumentos, el <code>stack</code> y la etiqueta <code>tag</code> para la extracción de índices de los datos y los efectos. Esto es, si consideramos algunos de los ejemplos previos podríamos emplear esta función como</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">index</span> <span class="o">&lt;-</span> <span class="nf">inla.stack.index</span><span class="p">(</span><span class="n">stack</span><span class="o">=</span><span class="n">inf_stack</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>El cual devuelve una lista con dos elementos, <code>data</code> y <code>effects</code>, con los correspondientes índices de los datos y los efectos que podemos emplear para extraerlos de la salida del ajuste del modelo para el predictor lineal.</p>
<p>Las otras dos funciones permite extraer los valores de los elementos del lado izquierdo de la fórmula (<code>inla.stack.LHS(...)</code>) y los del lado derecho (<code>inla.stack.RHS(...)</code>). En ambos casos sólo se necesita especificar el <em>stack</em> sobre el que se aplicará la función.</p>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <script src="../../../../js/clipboard.min.js" defer></script>
    <script src="../../../../js/perfect-scrollbar.min.js" defer></script>
    <script src="../../../../js/featherlight.min.js" defer></script>
    <script>
      function useMathJax( config ){
        if( !Object.assign ){
          
          return;
        }
        window.MathJax = Object.assign( window.MathJax || {}, {
          loader: {
            load: ['[tex]/mhchem']
          },
          startup: {
            elements: [
              '.math'
            ]
          },
          tex: {
            inlineMath: [
              ['$', '$'], 
              ['\\(', '\\)']
            ]
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="../../../../js/mathjax/tex-mml-chtml.js"></script>
    <script src="../../../../js/jquery.svg.pan.zoom.js" defer></script>
    <script src="../../../../js/mermaid.min.js" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{ \"securityLevel\": \"loose\" }");
    </script>
    <script src="../../../../js/theme.js" defer></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-105947713-1', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
