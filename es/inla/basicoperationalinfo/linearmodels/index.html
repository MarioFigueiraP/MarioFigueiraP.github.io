<!DOCTYPE html>
<html lang="es" dir="ltr">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="description" content="Ejemplos simples de modelos lineales y evaluación de la salida de la función ``inla(...)``.">
    <meta name="author" content="Mario Figueira">
    <title>Modelos Lineales Simples :: Documentación</title>
    <link href="../../../../es/inla/basicoperationalinfo/linearmodels/index.xml" rel="alternate" type="application/rss+xml" title="Modelos Lineales Simples :: Documentación">
    <link href="../../../../es/inla/basicoperationalinfo/linearmodels/index.print.html" rel="alternate" type="text/html" title="Modelos Lineales Simples :: Documentación">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="../../../../css/fontawesome-all.min.css" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fontawesome-all.min.css" rel="stylesheet"></noscript>
    <link href="../../../../css/featherlight.min.css" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/featherlight.min.css" rel="stylesheet"></noscript>
    <link href="../../../../css/auto-complete.css" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/auto-complete.css" rel="stylesheet"></noscript>
    <link href="../../../../css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="../../../../css/nucleus.css" rel="stylesheet">
    <link href="../../../../css/fonts.css" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="../../../../css/fonts.css" rel="stylesheet"></noscript>
    <link href="../../../../css/theme.css" rel="stylesheet">
    <link href="../../../../css/theme-learn.css" rel="stylesheet" id="variant-style">
    <link href="../../../../css/ie.css" rel="stylesheet">
    <link href="../../../../css/variant.css" rel="stylesheet">
    <link href="../../../../css/print.css" rel="stylesheet" media="print">
    <script src="../../../../js/url.js"></script>
    <script src="../../../../js/variant.js"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      window.index_js_url="../../../../es/index.search.js";
      var root_url="../../../../";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copiar en el portapapeles';
      window.T_Copied_to_clipboard = '¡Copiado al portapapeles!';
      window.T_Copy_link_to_clipboard = 'Copiar enlace al portapapeles';
      window.T_Link_copied_to_clipboard = '¡Enlace copiado al portapapeles!';
      window.T_No_results_found = 'No se han encontrado resultados para \u0022{0}\u0022';
      window.T_N_results_found = '{1} resultados encontrados para \u0022{0}\u0022';
      // some further base stuff
      var baseUriFull='https:\/\/MarioFigueiraP.github.io/';
      window.variants && variants.init( [ 'learn', 'relearn-light', 'relearn-dark', 'neon', 'blue', 'green', 'red' ] );
    </script>
    <script src="../../../../js/jquery.min.js" defer></script>
  </head>
  <body class="mobile-support html" data-url="../../../../es/inla/basicoperationalinfo/linearmodels/index.html">
    <div id="body" class="default-animation">
      <div id="sidebar-overlay"></div>
      <div id="toc-overlay"></div>
      <nav id="topbar" class="highlightable" dir="ltr">
        <div>
          <div class="navigation">
            <a class="nav nav-next" href="../../../../es/inla/basicoperationalinfo/stacks/index.html" title="Stacks (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a>
          </div>
          <div class="navigation">
            <a class="nav nav-prev" href="../../../../es/inla/basicoperationalinfo/index.html" title="Operaciones Básicas (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a>
          </div>
          <div id="top-print-link">
            <a class="print-link" title='Imprimir todo el capítulo (CTRL+ALT+p)' href="../../../../es/inla/basicoperationalinfo/linearmodels/index.print.html">
              <i class="fas fa-print fa-fw"></i>
            </a>
          </div>
          <div id="breadcrumbs">
            <span id="sidebar-toggle-span">
              <a href="#" id="sidebar-toggle" title='Menú (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a>
            </span>
            <span id="toc-menu" title='Tabla de contenido (CTRL+ALT+t)'><i class="fas fa-list-alt fa-fw"></i></span>
            <ol class="links" itemscope itemtype="http://schema.org/BreadcrumbList">
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../es/inla/index.html"><span itemprop="name">INLA</span></a><meta itemprop="position" content="1"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><a itemprop="item" href="../../../../es/inla/basicoperationalinfo/index.html"><span itemprop="name">Operaciones Básicas</span></a><meta itemprop="position" content="2"> > </li>
              <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement"><span itemprop="name">Modelos Lineales Simples</span><meta itemprop="position" content="3"></li>
            </ol>
          </div>
          <div class="default-animation progress">
            <div class="toc-wrapper" dir="ltr">
<nav id="TableOfContents">
  <ul>
    <li><a href="#1-modelo-gaussiano-con-un-interceptor-y-un-efecto-lineal">1. Modelo Gaussiano con un interceptor y un efecto lineal</a></li>
    <li><a href="#2-modelo-gaussiano-con-factores">2. Modelo Gaussiano con factores</a></li>
    <li><a href="#3-modelo-gaussiano-con-efectos-aleatorios">3. Modelo Gaussiano con efectos aleatorios</a>
      <ul>
        <li><a href="#31-efectos-aleatorios-no-estructurados-iid">3.1 Efectos aleatorios no-estructurados (<em>iid</em>)</a></li>
        <li><a href="#32-efectos-aleatorios-estructurados-en-una-dimensión-rw-ar-y-spde">3.2 Efectos aleatorios estructurados en una dimensión (<em>rw</em>, <em>ar</em> y <em>spde</em>)</a></li>
        <li><a href="#33-efectos-aleatorios-estructurados-en-dos-dimensiones-besag-y-spde">3.3 Efectos aleatorios estructurados en dos dimensiones (<em>besag</em> y <em>spde</em>)</a></li>
      </ul>
    </li>
  </ul>
</nav>
            </div>
          </div>
        </div>
      </nav>
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="default">
<h1 id="modelos-lineales-simples">Modelos Lineales Simples</h1>


<div class="box notices cstyle info">
    <div class="box-label"><i class="fa-fw fas fa-info"></i> Información de versiones</div>
    <div class="box-content">
<p>En este rótulo inicial exponemos una lista con las versiones de los programas, sistema operativo y librearías con las que se ha ejecutado el código de la presente sección, lo cual se extrae principalmente mediante la función <code>sessionInfo()</code>.</p>
<ul>
<li>SO (version): Windows 11 Home (22H2).</li>
<li>R: 4.2.3 (2023-03-15 ucrt).</li>
<li>RStudio: 2023.06.2 (Build 561).</li>
<li>Libraries:
<ul>
<li>INLA: INLA_23.04.24</li>
</ul>
</li>
</ul>
    </div>
</div>
<p>En esta sección se expondrán distintos ejemplos de modelos sencillos con datos simulados, para así mostrar cómo operar con <strong>R-INLA</strong>. A lo largo de los ejemplos se comentará el código empleado y se tratará de explicar el funcionamiento de las funciones empleadas relativas al paquete <strong>R-INLA</strong>, junto con las salidas de la función de ajuste <code>inla(...)</code>.</p>
<p>Los ejemplos sobre los que trabajaremos son los siguientes:</p>
<ol>
<li>Modelo Gaussiano con interceptor y efecto lineal.</li>
<li>Modelo Gaussiano con factores.</li>
<li>Modelo Gaussiano con efectos aleatorios.
<ol>
<li>Efectos aleatorios no-estructurados (<em>iid</em>)</li>
<li>Efectos aleatorios estructurados en una dimensión (<em>rw</em>, <em>ar</em> y <em>spde</em>)</li>
<li>Efectos aleatorios estructurados en dos dimensiones (<em>besag</em> y <em>spde</em>)</li>
</ol>
</li>
</ol>
<h2 id="1-modelo-gaussiano-con-un-interceptor-y-un-efecto-lineal">1. Modelo Gaussiano con un interceptor y un efecto lineal</h2>
<p>Un ejemplo de modelo Gaussiano sencillo puede ser aquel cuyo predictor lineal esté determinado por un interceptor y un efecto fijo asociado a una variable continua. Es decir, el modelo formalmente es expresable como</p>

<span class="math align-center">
$$\begin{array}{c}
y_i\sim N(\mu_i,\tau),\\
\mu_i = \eta_i = \beta_0 + \beta_1\cdot x_i,
\end{array}$$
</span>
<p>donde 
<span class="math align-center">$y_i$</span> son las realizaciones de la variable aleatoria respuesta 
<span class="math align-center">$Y:Y\sim N(\boldsymbol\mu,\tau)$</span>, 
<span class="math align-center">$\beta_0$</span> es el interceptor, 
<span class="math align-center">$\beta_1$</span> es el parámetro realativo al efecto de la variable explicativa 
<span class="math align-center">$\mathbf{x}$</span>, y 
<span class="math align-center">$x_i$</span> son los valores de la variable explicativa. El código que podríamos utilizar para simular este modelo es el presentado en el siguiente bloque de código.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">beta_0</span> <span class="o">&lt;-</span> <span class="m">-2</span>
</span></span><span class="line"><span class="cl"><span class="n">beta_1</span> <span class="o">&lt;-</span> <span class="m">4</span>
</span></span><span class="line"><span class="cl"><span class="n">lin_pred</span> <span class="o">&lt;-</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span><span class="o">*</span><span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">lin_pred</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span></code></pre></div><p>Antes de organizar la información de los datos podemos especificar la fórmula del modelo,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">formula_inla</span> <span class="o">&lt;-</span> <span class="n">y</span> <span class="o">~</span> <span class="m">-1</span> <span class="o">+</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span>
</span></span></code></pre></div><p>donde <code>y</code> es el nombre de la variable respuesta, el término <code>-1</code> elimina el interceptor que se construye por defecto, mientras que <code>beta_0</code> y <code>beta_1</code> son dos parámetros o variables fijas, a las que en el <code>data.frame</code> o la matriz de proyección <code>A</code> se pasarán los pesos asociados a los mismos. En el caso de un interceptor estos pesos sería un vector de unos, mientras que los pesos de los parámetros relativos a las variables explicativas tendrán por pesos los valores de dichas variables.</p>
<p>En la propia fórmula podemos indicar la distribución previa de los parámetros, en concreto para el caso de los efectos lineales lo haríamos como</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">formula_inla</span> <span class="o">&lt;-</span> <span class="n">y</span> <span class="o">~</span> <span class="m">-1</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">f</span><span class="p">(</span><span class="n">beta_0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s">&#34;linear&#34;</span><span class="p">,</span> <span class="n">mean.linear</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">prec.linear</span><span class="o">=</span><span class="m">0.001</span><span class="p">)</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">f</span><span class="p">(</span><span class="n">beta_1</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s">&#34;linear&#34;</span><span class="p">,</span> <span class="n">mean.linear</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">prec.linear</span><span class="o">=</span><span class="m">0.001</span><span class="p">)</span>
</span></span></code></pre></div><p>La información podemos prepararla mediante la función <code>inla.stack(...)</code> para pasarla a la función de ajuste <code>inla(...)</code>, (véase la <a href="https://mariofigueirap.github.io/es/inla/basicoperationalinfo/stacks/index.html">sección dedicada a los <em>stacks</em></a> para más información).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inf_stack</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">    <span class="nf">inla.stack</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="m">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">effects</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">beta_0</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">                <span class="n">beta_1</span><span class="o">=</span><span class="n">x</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">tag</span><span class="o">=</span><span class="s">&#34;inf_stack&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><p>El ajuste del modelo lo realizamos mediante <code>inla(...)</code>, donde indicamos la fórmula, la distribución de la verosimilitud, los datos necesarios para el modelo (que podemos extraer del <em>stack</em> mediante <code>inla.stack.data(...)</code>), y otros elementos de configuración que podemos especificar.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">inla_model</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">inla</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">formula</span><span class="o">=</span><span class="n">formula_inla</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nf">inla.stack.data</span><span class="p">(</span><span class="n">inf_stack</span><span class="p">),</span> <span class="n">family</span><span class="o">=</span><span class="s">&#34;gaussian&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">control.predictor</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">A</span><span class="o">=</span><span class="nf">inla.stack.A</span><span class="p">(</span><span class="n">inf_stack</span><span class="p">),</span> <span class="n">compute</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">control.compute</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">waic</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">cpo</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">dic</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">verbose</span><span class="o">=</span><span class="kc">TRUE</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><p>En la función <code>inla(...)</code> hemos especificado la fórmula, la distribución de los datos, la matriz de proyección, y además con <code>control.predictor(compute=TRUE)</code> indicamos que se calculen las distribuciones marginales del predictor lineal (para almacenarlas se necesitaría especificar con un argumento extra <code>return.marginals.predictor=TRUE</code>). Con <code>control.compute(waic=TRUE, cpo=TRUE, dic=TRUE, config=TRUE)</code> indicamos que se calcule el WAIC, CPO, DIC, y que la aproximación GMRF interna se almacene.</p>
<p>La salida de la función, guardada en el objeto <code>inla_model</code> según el código empleado, tendremos ciertos sumarios (<em>summaries</em>) de información sobre el ajuste:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Argumento</th>
<th style="text-align:left">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">summary.fixed</td>
<td style="text-align:left">Resumen de información de las distribuciones posteriores de los efectos fijos.</td>
</tr>
<tr>
<td style="text-align:center">summary.hyperpar</td>
<td style="text-align:left">Resumen de las distribuciones posteriores de los hiper-parámetros (parámetros asociados a la estructura de los efectos aleatorios y de los hiperparámetros de la verosimilitud).</td>
</tr>
<tr>
<td style="text-align:center">summary.random</td>
<td style="text-align:left">Resumen de las distribuciones posteriores para cada uno de los elementos (nodos) de los efectos aleatorios.</td>
</tr>
<tr>
<td style="text-align:center">summary.linear.predictor</td>
<td style="text-align:left">Resumen de las distribuciones posteriores del predictor lineal y el campo latente. Esto se divide en dos partes, una nombrada bajo la siguiente estructura: <code>fitted.APredictor.n</code>, donde <code>n</code> es un valor numérico relativo a la posición asociada a la observación <code>y_n</code>, y <code>fitted.Predictor.m</code>, donde <code>m</code> es un valor numérico relativo a la posición asociada al elemento <code>x_m</code> del campo Gaussiano latente. Es decir, la primera es tras aplicar la matriz de proyección <code>A</code> sobre las observaciones, mientras que la segunda es la relativa al campo latente en sentido estricto. Esto puede volverse algo más complejo al emplear múltiples <em>stacks</em> y múltiples verosimilitudes.</td>
</tr>
</tbody>
</table>
<p>Otros elementos muy útiles de la salida del modelo son las distribuciones marginales, tanto de los parámetros e hiperparámetros, así como de los efectos aleatorios y el predictor lineal.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Argumento</th>
<th style="text-align:left">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">marginals.fixed</td>
<td style="text-align:left">Distribuciones posteriores de los efectos fijos.</td>
</tr>
<tr>
<td style="text-align:center">marginals.hyperpar</td>
<td style="text-align:left">Distribuciones posteriores de los hiper-parámetros (parámetros asociados a la estructura de los efectos aleatorios y de los hiperparámetros de la verosimilitud).</td>
</tr>
<tr>
<td style="text-align:center">marginals.random</td>
<td style="text-align:left">Distribuciones posteriores para cada uno de los elementos (nodos) de los efectos aleatorios.</td>
</tr>
<tr>
<td style="text-align:center">marginals.linear.predictor</td>
<td style="text-align:left">Distribuciones posteriores del predictor lineal y el campo latente. Esto se divide en dos partes, una nombrada bajo la siguiente estructura: <code>fitted.APredictor.n</code> y <code>fitted.Predictor.m</code>, al igual que habíamos explicado para el resumen de las mismas.</td>
</tr>
</tbody>
</table>
<p>Finalmente, otros elementos de gran interés en la salida del modelo son los valores del DIC, WAIC, CPO y la verosimilitud marginal (<code>mlik</code>).</p>
<table>
<thead>
<tr>
<th style="text-align:center">Argumento</th>
<th style="text-align:left">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">marginals.fixed</td>
<td style="text-align:left">Distribuciones posteriores de los efectos fijos.</td>
</tr>
<tr>
<td style="text-align:center">marginals.hyperpar</td>
<td style="text-align:left">Distribuciones posteriores de los hiper-parámetros (parámetros asociados a la estructura de los efectos aleatorios y de los hiperparámetros de la verosimilitud).</td>
</tr>
<tr>
<td style="text-align:center">marginals.random</td>
<td style="text-align:left">Distribuciones posteriores para cada uno de los elementos (nodos) de los efectos aleatorios.</td>
</tr>
<tr>
<td style="text-align:center">mlik</td>
<td style="text-align:left">Verosimilitud marginal para la distintas verosimilitudes.</td>
</tr>
</tbody>
</table>
<h2 id="2-modelo-gaussiano-con-factores">2. Modelo Gaussiano con factores</h2>
<p>En este caso vamos a exponer como se pueden tratar de analizar datos con variables explicativas que son factores con INLA. El modelo del que simularemos los datos es el siguiente</p>

<span class="math align-center">
$$\begin{array}{c}
y_i\sim N(\mu_i,\tau),\\
\mu_i = \eta_i = \beta_0 + \sum_{f=1}^{F}\beta_{f} \cdot x_{if},
\end{array}$$
</span>
<p>donde 
<span class="math align-center">$\beta_0$</span> es el interceptor, 
<span class="math align-center">$\beta_f$</span> es el parámetro realativo al efecto de la variable explicativa 
<span class="math align-center">$\mathbf{X}$</span>. En este caso 
<span class="math align-center">$\mathbf{X}$</span> es una variable de tipo factor que, en general, tiene 
<span class="math align-center">$f=\{1,...,F\}$</span> niveles, tal que 
<span class="math align-center">$(\forall i) (\exists! f) : \left\lbrace x_{if}=1 \wedge x_{i,-f}=\mathbf{0}\right\rbrace$</span>. Por tanto, para cada observación sólo uno de estos niveles tiene asociado un valor . El código que podríamos utilizar para simular este modelo es el presentado en el siguiente bloque de código.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">beta_0</span> <span class="o">&lt;-</span> <span class="m">-2</span>
</span></span><span class="line"><span class="cl"><span class="n">beta_1</span> <span class="o">&lt;-</span> <span class="m">4</span>
</span></span><span class="line"><span class="cl"><span class="n">lin_pred</span> <span class="o">&lt;-</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span><span class="o">*</span><span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">1E2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">lin_pred</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span></code></pre></div><p>Antes de organizar la información de los datos podemos especificar la fórmula del modelo,</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">formula_inla</span> <span class="o">&lt;-</span> <span class="n">y</span> <span class="o">~</span> <span class="m">-1</span> <span class="o">+</span> <span class="n">beta_0</span> <span class="o">+</span> <span class="n">beta_1</span>
</span></span></code></pre></div><h2 id="3-modelo-gaussiano-con-efectos-aleatorios">3. Modelo Gaussiano con efectos aleatorios</h2>
<h3 id="31-efectos-aleatorios-no-estructurados-iid">3.1 Efectos aleatorios no-estructurados (<em>iid</em>)</h3>
<h3 id="32-efectos-aleatorios-estructurados-en-una-dimensión-rw-ar-y-spde">3.2 Efectos aleatorios estructurados en una dimensión (<em>rw</em>, <em>ar</em> y <em>spde</em>)</h3>
<h3 id="33-efectos-aleatorios-estructurados-en-dos-dimensiones-besag-y-spde">3.3 Efectos aleatorios estructurados en dos dimensiones (<em>besag</em> y <em>spde</em>)</h3>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    <aside id="sidebar" class="default-animation showVisitedLinks" dir="ltr">
      <div id="header-wrapper" class="default-animation">
        <div id="header" class="default-animation">

<a id="logo" href='../../../../es'>
	<img src="../../../../media/logo.png" alt="logo.png">
</a>
        </div>
        <form action="../../../../es/search.html" method="get"><div class="searchbox default-animation">
          <button type="submit" title="Buscar (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
          <label class="a11y-only" for="search-by">Buscar</label>
          <input data-search-input id="search-by" name="search-by" class="search-by" type="search" placeholder="Buscar...">
          <span data-search-clear=""><i class="fas fa-times"></i></span>
        </div></form>
        <script>
          var contentLangs=['es'];
        </script>
        <script src="../../../../js/auto-complete.js" defer></script>
        <script src="../../../../js/lunr.min.js" defer></script>
        <script src="../../../../js/lunr.stemmer.support.min.js" defer></script>
        <script src="../../../../js/lunr.multi.min.js" defer></script>
        <script src="../../../../js/lunr.es.min.js" defer></script>
        <script src="../../../../js/search.js" defer></script>
      </div>
      <div id="content-wrapper" class="highlightable">
        <ul class="topics collapsible-menu">
          <li data-nav-id="/es/inla/index.html" class="dd-item parent"><input type="checkbox" id="section-3d8afea5515ebe07961312ecdef11d71" aria-controls="subsections-3d8afea5515ebe07961312ecdef11d71" class="toggle" checked><label class="a11y-only toggle" for="section-3d8afea5515ebe07961312ecdef11d71" >Submenú INLA</label><a href="../../../../es/inla/index.html"><b>1. </b>INLA<i class="fas fa-check read-icon"></i></a><ul id="subsections-3d8afea5515ebe07961312ecdef11d71">
          <li data-nav-id="/es/inla/basicoperationalinfo/index.html" class="dd-item parent"><input type="checkbox" id="section-d33a80c8ca404888025a920ae41964d5" aria-controls="subsections-d33a80c8ca404888025a920ae41964d5" class="toggle" checked><label class="a11y-only toggle" for="section-d33a80c8ca404888025a920ae41964d5" >Submenú Operaciones Básicas</label><a href="../../../../es/inla/basicoperationalinfo/index.html">Operaciones Básicas<i class="fas fa-check read-icon"></i></a><ul id="subsections-d33a80c8ca404888025a920ae41964d5">
          <li data-nav-id="/es/inla/basicoperationalinfo/linearmodels/index.html" class="dd-item active"><a href="../../../../es/inla/basicoperationalinfo/linearmodels/index.html">Modelos Lineales Simples<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/es/inla/basicoperationalinfo/stacks/index.html" class="dd-item"><a href="../../../../es/inla/basicoperationalinfo/stacks/index.html">Stacks<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/es/inla/basicoperationalinfo/meshes/index.html" class="dd-item"><a href="../../../../es/inla/basicoperationalinfo/meshes/index.html">Conformación de Mallas<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/es/inla/basicoperationalinfo/advanced_features/index.html" class="dd-item"><a href="../../../../es/inla/basicoperationalinfo/advanced_features/index.html">Características Avanzadas<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/es/inla/extensions/index.html" class="dd-item"><input type="checkbox" id="section-88d39a17e227884620f6481637dd81cc" aria-controls="subsections-88d39a17e227884620f6481637dd81cc" class="toggle"><label class="a11y-only toggle" for="section-88d39a17e227884620f6481637dd81cc" >Submenú Extensiones de INLA</label><a href="../../../../es/inla/extensions/index.html">Extensiones de INLA<i class="fas fa-check read-icon"></i></a><ul id="subsections-88d39a17e227884620f6481637dd81cc">
          <li data-nav-id="/es/inla/extensions/dirinla/index.html" class="dd-item"><input type="checkbox" id="section-16d704edcc40db29f19556de248b7ece" aria-controls="subsections-16d704edcc40db29f19556de248b7ece" class="toggle"><label class="a11y-only toggle" for="section-16d704edcc40db29f19556de248b7ece" >Submenú dirinla</label><a href="../../../../es/inla/extensions/dirinla/index.html">dirinla<i class="fas fa-check read-icon"></i></a><ul id="subsections-16d704edcc40db29f19556de248b7ece">
          <li data-nav-id="/es/inla/extensions/dirinla/linear_effects/index.html" class="dd-item"><a href="../../../../es/inla/extensions/dirinla/linear_effects/index.html">Ejemplos con efectos fijos<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/es/inla/extensions/dirinla/unstructure_random_effects/index.html" class="dd-item"><a href="../../../../es/inla/extensions/dirinla/unstructure_random_effects/index.html">Ejemplos con efectos iid aleatorios<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/es/inla/extensions/dirinla/spde2_random_effects/index.html" class="dd-item"><a href="../../../../es/inla/extensions/dirinla/spde2_random_effects/index.html">Ejemplos con efectos aleatorios espacialmente estructurados<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li>
          <li data-nav-id="/es/inla/variousfunctions/index.html" class="dd-item"><input type="checkbox" id="section-647dff3011d5e04f7f57bb0bf5f84eb8" aria-controls="subsections-647dff3011d5e04f7f57bb0bf5f84eb8" class="toggle"><label class="a11y-only toggle" for="section-647dff3011d5e04f7f57bb0bf5f84eb8" >Submenú Funciones Varias</label><a href="../../../../es/inla/variousfunctions/index.html">Funciones Varias<i class="fas fa-check read-icon"></i></a><ul id="subsections-647dff3011d5e04f7f57bb0bf5f84eb8">
          <li data-nav-id="/es/inla/variousfunctions/inlatosp/index.html" class="dd-item"><a href="../../../../es/inla/variousfunctions/inlatosp/index.html">Transformación a sp/sf<i class="fas fa-check read-icon"></i></a></li></ul></li>
          <li data-nav-id="/es/inla/spatialmodels/index.html" class="dd-item"><input type="checkbox" id="section-db6daab276ae6b8a9baf7582683f1fe5" aria-controls="subsections-db6daab276ae6b8a9baf7582683f1fe5" class="toggle"><label class="a11y-only toggle" for="section-db6daab276ae6b8a9baf7582683f1fe5" >Submenú Modelos Espaciales (SPDE-FEM)</label><a href="../../../../es/inla/spatialmodels/index.html">Modelos Espaciales (SPDE-FEM)<i class="fas fa-check read-icon"></i></a><ul id="subsections-db6daab276ae6b8a9baf7582683f1fe5">
          <li data-nav-id="/es/inla/spatialmodels/geostatisticalmodel/index.html" class="dd-item"><a href="../../../../es/inla/spatialmodels/geostatisticalmodel/index.html">Modelo Geoestadístico<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/es/inla/spatialmodels/jointmodel_preferential/index.html" class="dd-item"><a href="../../../../es/inla/spatialmodels/jointmodel_preferential/index.html">Modelo Preferencial<i class="fas fa-check read-icon"></i></a></li>
          <li data-nav-id="/es/inla/spatialmodels/spatialvaryingcoefficientmodel/index.html" class="dd-item"><a href="../../../../es/inla/spatialmodels/spatialvaryingcoefficientmodel/index.html">Modelo SVC<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li>
          <li data-nav-id="/es/inlabru/index.html" class="dd-item"><a href="../../../../es/inlabru/index.html"><b>2. </b>inlabru<i class="fas fa-check read-icon"></i></a></li>
        </ul>
        <div id="shortcuts">
          <div class="nav-title">Más</div>
          <ul>
            <li><a class="padding" href="https://github.com/MarioFigueiraP"><i class='fab fa-fw fa-github'></i> GitHub Principal</a></li>
            <li><a class="padding" href="https://github.com/MarioFigueiraP/ShinyAppSpatialModelFeedback"><i class='fab fa-fw fa-github'></i> Modelización Espacial ShinyApp</a></li>
          </ul>
        </div>
        <div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVariantSwitch showVisitedLinks"></div>
        <hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVariantSwitch showVisitedLinks">
        <div id="prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showLangSwitch showVariantSwitch showVisitedLinks">
          <ul>
            <li id="select-language-container" class="footerLangSwitch showLangSwitch">
              <div class="padding select-container">
                <i class="fas fa-language fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-language">Idioma</label>
                  <select id="select-language" onchange="location = baseUri + this.value;">
                    <option lang="en" id="en" value="/inla/basicoperationalinfo/linearmodels/index.html">English</option>
                    <option lang="es" id="es" value="/es/inla/basicoperationalinfo/linearmodels/index.html" selected>Español</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
            </li>
            <li id="select-variant-container" class="footerVariantSwitch showVariantSwitch">
              <div class="padding select-container">
                <i class="fas fa-paint-brush fa-fw"></i>
                <span>&nbsp;</span>
                <div class="select-style">
                  <label class="a11y-only" for="select-variant">Tema</label>
                  <select id="select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                    <option id="learn" value="learn" selected>Learn</option>
                    <option id="relearn-light" value="relearn-light">Relearn Light</option>
                    <option id="relearn-dark" value="relearn-dark">Relearn Dark</option>
                    <option id="neon" value="neon">Neon</option>
                    <option id="blue" value="blue">Blue</option>
                    <option id="green" value="green">Green</option>
                    <option id="red" value="red">Red</option>
                  </select>
                </div>
                <div class="select-clear"></div>
              </div>
              <script>window.variants && variants.markSelectedVariant();</script>
            </li>
            <li class="footerVisitedLinks showVisitedLinks"><button class="padding" onclick="clearHistory();"><i class="fas fa-history fa-fw"></i> Borrar Historial</button></li>
          </ul>
        </div>
        <div id="footer" class="footerFooter">
        </div>
      </div>
    </aside>
    <script src="../../../../js/clipboard.min.js" defer></script>
    <script src="../../../../js/perfect-scrollbar.min.js" defer></script>
    <script src="../../../../js/featherlight.min.js" defer></script>
    <script>
      function useMathJax( config ){
        if( !Object.assign ){
          
          return;
        }
        window.MathJax = Object.assign( window.MathJax || {}, {
          loader: {
            load: ['[tex]/mhchem']
          },
          startup: {
            elements: [
              '.math'
            ]
          },
          tex: {
            inlineMath: [
              ['$', '$'], 
              ['\\(', '\\)']
            ]
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="../../../../js/mathjax/tex-mml-chtml.js"></script>
    <script src="../../../../js/jquery.svg.pan.zoom.js" defer></script>
    <script src="../../../../js/mermaid.min.js" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{ \"securityLevel\": \"loose\" }");
    </script>
    <script src="../../../../js/theme.js" defer></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-105947713-1', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
